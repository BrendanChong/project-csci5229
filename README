Level-Set phase visualizer for MORIS GUI

author: Brendan Chong
TOTAL TIME: 40 hours?

The project is intended to be used alongside a Qt GUI (in development) for an immersed Finite Element codebase.
In the code, geometries are defined by the union of Level-Set functions defined over the mesh domain. Each Level-Set function can either be positive, negative, or zero.

To map the Level-Set to a phase, and eventually a material in the physics problem, a phase table must be specified. The phase table provides a phase index to every possible combination of +/- for each geometry. Thus, the phase table is necessarily of size 2^num_geometries. The default phase table for 3 geometries is listed below

        Level-Set Field index  
            0   1   2
---------------------------------------
Phase 0 |   -   -   -   |
Phase 1 |   -   -   +   |
Phase 2 |   -   +   -   |
Phase 3 |   -   +   +   |
Phase 4 |   +   -   -   |
Phase 5 |   +   -   +   |
Phase 6 |   +   +   -   |
Phase 7 |   +   +   +   |

Note that multiple bitsets (combinations of +/- for each geometry) can be mapped to the same index. This code shows both the plots of the Level-Set functions, as well as the resulting phase distribution. It allows for arbitrary Level-Set functions to be added at the user discretion and different phase tables to be assigned.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

-------CONTROLS---------
    GENERAL:
        mouse   : Click and drag to rotate the Level-Set geometries and view different features
        scroll  : Move the z-clipping plane forward and backward
        l       : Toggles lighting
        / or ?  : Loads demo. Auto-loaded by default, so will not do anything unless geometries have been changed
        Space   : Display all bitsets in the projection view and all Level-Sets in the plotter view.
        q       : Swaps the viewports (plotter view <-> projection view)
        

    LEVEL-SET ASSIGNMENTS:
        n       : Add a new Level-Set geometry (maximum 5). A prompt will appear in the terminal to type the function
        0-4     : View only the Level-Set geometry assigned to that index
        Enter   : Edits the currently active geometry (Ex. press 1, Enter to change the equation for LS1)
        d       : Deletes the current Level-Set geometry and shifts the remaining geometries down. If all geometries are currently being viewed, it will delete geometry 0
        i       : Toggles bisection method to supplement points along the zero isocontour

    PHASE CONTROLS:
        p       : Set entire phase table. A prompt will appear in the terminal to type a comma or space separated vector for the phase table.
                  Note that the phase table is visualized on the screen
        _       : (Underscore) Views phase 0 since there is no F0 key
        F1-F12  : View the phase associated with that key (ie. F1 shows phase 1). The view is populated on both the main plot viewer as well as the projection
        +       : Shows the regions where any currently viewed Level-Sets are positive
        -       : Shows the regions where any currently viewed Level-Sets are negative
        Right Click : If the projection is the main view, right clicking a bitset selects it. Pressing the enter key while in this state will allow the user to change the phase for the selected bitset only.
        r       : Resets the phase table to set every bitset to a unique phase index. 


-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

FEATURES:

Toggling between the two different viewports adds a great deal of convenience changes the flow of inputs. I like how this is implemented and makes it inuitive to interact with the plots to get the data that you want to see.

Clicking a part of the domain highlights it and allows for really simple editing of the phases visually. I did this by unprojecting the pixel coordinates to get the world coordinates, and then evaluating the Level-Set fields to get the bitset at that point. 

I implemented a somewhat slick way to compute zero-isocontour values without having to do something more complex like marching squares. To do this, I render the geometries on the fixed mesh like normal if all the points are in the domain I requested to plot. However, if I detect that the points are along the zero-isocontour when plotting, I instead compute the root using the bisection method and then add the triangle with the root instead of the coordinate that is outside the requested plotting domain. This only ended up making a minor difference in terms of the visual fidelity of the plot, but is still a cool piece of technology.

The color coordinating of the phase table was surprisingly more complex than I thought it would be, since the text is printed in pixel coordinates but vertices are typically drawn in world coordinates. Additionally, getting the alignment of the phase table to be correct no matter how many phases took some work. AI helped with this section more significantly than anywhere else, as it wrote the function to get the legth of strings printed to the screen. One small detail that wasn't particularly difficult to implement but I think adds a nice touch is that when I bitset is selected, the color key also gets the associated texture.

Overall, what I'm most proud of is feedback from my lab. I worked closely with other students in the lab as well as my advisor to implement all the features they asked, resulting in a project that we're all excited about and will get implemented into our daily workflow. I prioritized utility over asthetics here, and the result is a tool that is intuitive to use and interact with if you're familiar with our lab's code. Thus, I'm sure this project will long outlive the lifespan of the course. Although I find a lot of value in this, I understand it may not reflect the course material as best as possible, and am accepting of the fact that my score on the project may reflect that. However, I also think that applying the tools taught in the class in a practical way should also be taken into consideration when scoring the project.

Thank you for a great semester!
